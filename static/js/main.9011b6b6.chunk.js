(window["webpackJsonpbraingeneers-things-console"]=window["webpackJsonpbraingeneers-things-console"]||[]).push([[0],{226:function(e,t,n){e.exports=n(796)},231:function(e,t,n){},74:function(e,t){},796:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(32),i=n.n(r),c=(n(231),n(52)),s=n.n(c),u=n(98),l=n(215),h=n(44),d=n(216),p=n(217),g=n(222),m=n(810),b=n(811),f=n(812),w=n(813),v=n(814),y=n(815),k=n(221),S=n.n(k),A=n(67),E=n.n(A),O=n(218),I=n(29),x=n.n(I),P=n(97),j={Auth:{identityPoolId:"us-west-2:f533019d-9cbe-4a39-ad43-574c7316ad26",region:"us-west-2",userPoolId:"us-west-2_d9YBsfCk1",userPoolWebClientId:"54n46fo7gq5vprpg74qo4b8825",mandatorySignIn:!0,oauth:{domain:"braingeneers.auth.us-west-2.amazoncognito.com",scope:["email","openid"],redirectSignIn:"http://localhost:3000/",redirectSignOut:"http://localhost:3000/",responseType:"token"}}};x.a.configure(j);var C=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={user:null,iot:null,things:null,loaded:!1,authenticated:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,I.Auth.currentAuthenticatedUser();case 3:return e.t1=e.sent,e.t2={user:e.t1},e.t0.setState.call(e.t0,e.t2),e.next=8,I.Auth.currentCredentials();case 8:return t=e.sent,E.a.config.update({region:j.Auth.region,accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,sessionToken:t.sessionToken}),e.prev=10,n=new E.a.Iot({credentials:t}),this.setState({iot:n}),e.t3=this,e.next=16,this.state.iot.listThings().promise();case 16:e.t4=e.sent,e.t5={things:e.t4},e.t3.setState.call(e.t3,e.t5),n.attachPrincipalPolicy({policyName:"default",principal:t.identityId},(function(e,t){e&&console.error(e)})),x.a.addPluggable(new P.AWSIoTProvider({aws_pubsub_region:j.Auth.region,aws_pubsub_endpoint:"wss://ahp00abmtph4i-ats.iot.us-west-2.amazonaws.com/mqtt"})),I.PubSub.subscribe("picroscope/#").subscribe({next:function(e){return console.log("Message received",e)},error:function(e){return console.error(e)},close:function(){return console.log("Done")}}),this.setState({authenticated:!0}),e.next=28;break;case 25:e.prev=25,e.t6=e.catch(10),console.log("Unable to authenticate",e.t6);case 28:this.setState({loaded:!0});case 29:case"end":return e.stop()}}),e,this,[[10,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("".concat(t,"/").concat(n),a),e.next=3,I.PubSub.publish("".concat(t,"/").concat(n),{msg:a});case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loaded?this.state.authenticated?o.a.createElement(m.a,null,o.a.createElement(b.a,{variant:"outlined",onClick:function(){return I.Auth.signOut()}},"Sign Out"),o.a.createElement(f.a,null,this.state.things.things.map((function(t){return o.a.createElement(w.a,{key:t.thingArn},o.a.createElement(v.a,null,o.a.createElement(S.a,null)),o.a.createElement(y.a,{primary:t.thingName}),o.a.createElement(b.a,{variant:"outlined",color:"primary",onClick:function(){return e.publish("picroscope","start","a message")}},"Start"),o.a.createElement(b.a,{variant:"outlined",color:"secondary",onClick:function(){return e.publish("picroscope","stop","a message")}},"Stop"))})))):o.a.createElement(m.a,null,o.a.createElement(b.a,{variant:"outlined",onClick:function(){return I.Auth.signOut()}},"Sign Out"),"Not authorized"):o.a.createElement("div",null,"Loading...")}}]),t}(a.Component),T=Object(O.withAuthenticator)(C);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},81:function(e,t){}},[[226,1,2]]]);
//# sourceMappingURL=main.9011b6b6.chunk.js.map