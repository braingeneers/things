(window["webpackJsonpbraingeneers-things-console"]=window["webpackJsonpbraingeneers-things-console"]||[]).push([[0],{188:function(e,t,a){e.exports=a(675)},193:function(e,t,a){},675:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(16),s=a.n(i),o=(a(193),a(49)),l=a.n(o),c=a(167),u=a(168),m=a(178),h=a(169),d=a(179),g=a(703),p=a(707),v=a(708),f=a(709),b=a(713),w=a(711),_=a(710),k=a(677),y=a(712),E=a(714),S=a(176),C=a.n(S),z=a(61),I=a.n(z),P=a(177),O=a(41),x=a(173),A={Auth:{identityPoolId:"us-west-2:f533019d-9cbe-4a39-ad43-574c7316ad26",region:"us-west-2",userPoolId:"us-west-2_d9YBsfCk1",userPoolWebClientId:"54n46fo7gq5vprpg74qo4b8825",mandatorySignIn:!0,oauth:{domain:"braingeneers.auth.us-west-2.amazoncognito.com",scope:["email","openid","profile"],redirectSignIn:"localhost"===window.location.hostname?"http://localhost:3000/":"https://braingeneers.gi.ucsc.edu/things/",redirectSignOut:"localhost"===window.location.hostname?"http://localhost:3000/":"https://braingeneers.gi.ucsc.edu/things/",responseType:"token"}}};O.c.configure(A);var T=[{value:"gfp",label:"GFP"},{value:"white",label:"Bright Field"}],j=[{value:"-t 4000 -ss 2500000 -awb off -awbg 1,1 -o",label:"GFP"},{value:"-t 4000 -awb off -awbg 1,1 -o",label:"Bright Field"}],B=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,iot:null,things:null,uuid:(new Date).toISOString().split("T")[0],interval:2,stack_size:5,stack_offset:500,step_size:100,camera_params:"-t 4000 -awb off -awbg 1,1 -o",light_mode:"white",loaded:!1,authenticated:!1},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e,t;return l.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=this,a.next=3,l.a.awrap(O.a.currentAuthenticatedUser());case 3:return a.t1=a.sent,a.t2={user:a.t1},a.t0.setState.call(a.t0,a.t2),a.next=8,l.a.awrap(O.a.currentCredentials());case 8:return e=a.sent,I.a.config.update({region:A.Auth.region,accessKeyId:e.accessKeyId,secretAccessKey:e.secretAccessKey,sessionToken:e.sessionToken}),a.prev=10,t=new I.a.Iot({credentials:e}),this.setState({iot:t}),a.t3=this,a.next=16,l.a.awrap(this.state.iot.listThings().promise());case 16:a.t4=a.sent,a.t5={things:a.t4},a.t3.setState.call(a.t3,a.t5),t.attachPrincipalPolicy({policyName:"default",principal:e.identityId},(function(e,t){e&&console.error(e)})),O.c.addPluggable(new x.AWSIoTProvider({aws_pubsub_region:A.Auth.region,aws_pubsub_endpoint:"wss://ahp00abmtph4i-ats.iot.us-west-2.amazonaws.com/mqtt"})),O.b.subscribe("picroscope/#").subscribe({next:function(e){return console.log("Message received",e)},error:function(e){return console.error(e)},close:function(){return console.log("Done")}}),this.setState({authenticated:!0}),a.next=28;break;case 25:a.prev=25,a.t6=a.catch(10),console.log("Unable to authenticate",a.t6);case 28:this.setState({loaded:!0});case 29:case"end":return a.stop()}}),null,this,[[10,25]])}},{key:"publish",value:function(e,t){var a,n=arguments;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n.length>2&&void 0!==n[2]?n[2]:{},console.log("".concat(e,"/").concat(t),a),r.next=4,l.a.awrap(O.b.publish("".concat(e,"/").concat(t),a));case 4:case"end":return r.stop()}}))}},{key:"render",value:function(){var e=this;return this.state.loaded?this.state.authenticated?r.a.createElement("form",null,r.a.createElement(g.a,{position:"static"},r.a.createElement(f.a,null,r.a.createElement("img",{src:"logo36.png",alt:"Braingeneers"}),r.a.createElement(p.a,{color:"inherit",onClick:function(){return O.a.signOut()}},"Logout"))),r.a.createElement(b.a,{id:"uuid",label:"UUID",value:this.state.uuid,onChange:function(t){return e.setState({uuid:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"stack_size",label:"Stack Size",value:this.state.stack_size,onChange:function(t){return e.setState({stack_size:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"step_size",label:"Step Size",value:this.state.step_size,onChange:function(t){return e.setState({step_size:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"stack_offset",label:"Step Offset",value:this.state.stack_offset,onChange:function(t){return e.setState({stack_offset:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"interval",label:"Interval (hours)",value:this.state.interval,onChange:function(t){return e.setState({interval:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"camera_params",label:"Camera Command Parameters",value:this.state.camera_params,onChange:function(t){return e.setState({camera_params:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(b.a,{id:"outlined-select-cam-params",select:!0,label:"Camera Parameter Presets",value:this.state.camera_params,onChange:function(t){return e.setState({camera_params:t.target.value})},margin:"normal",style:{width:190},variant:"outlined"},j.map((function(e){return r.a.createElement(w.a,{key:e.value,value:e.value},e.label)}))),r.a.createElement(b.a,{id:"outlined-select-currency",select:!0,label:"Light Type",value:this.state.light_mode,onChange:function(t){return e.setState({light_mode:t.target.value})},margin:"normal",style:{width:190},variant:"outlined"},T.map((function(e){return r.a.createElement(w.a,{key:e.value,value:e.value},e.label)}))),r.a.createElement(_.a,null,this.state.things.things.map((function(t){return r.a.createElement(k.a,{key:t.thingArn},r.a.createElement(y.a,null,r.a.createElement(C.a,null)),r.a.createElement(E.a,{primary:t.thingName}),r.a.createElement(p.a,{variant:"outlined",color:"primary",onClick:function(){return e.publish(t.thingName,"start",{uuid:e.state.uuid,params:{interval:e.state.interval,stack_size:e.state.stack_size,stack_offset:e.state.stack_offset,step_size:e.state.step_size,camera_params:e.state.camera_params,light_mode:e.state.light_mode}})}},"Start"),r.a.createElement(p.a,{variant:"outlined",color:"secondary",onClick:function(){return e.publish(t.thingName,"stop",{})}},"Stop"))})))):r.a.createElement("div",null,r.a.createElement(g.a,{position:"static"},r.a.createElement(p.a,{color:"inherit",onClick:function(){return O.a.signOut()}},"Logout")),r.a.createElement(v.a,null,"You're email address has not been authorized")):r.a.createElement("div",null,"Loading...")}}]),t}(n.Component),D=Object(P.a)(B);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},80:function(e,t){},87:function(e,t){}},[[188,1,2]]]);
//# sourceMappingURL=main.7f1f19dd.chunk.js.map