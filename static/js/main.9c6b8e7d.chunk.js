(window["webpackJsonpbraingeneers-things-console"]=window["webpackJsonpbraingeneers-things-console"]||[]).push([[0],{191:function(e,t,a){e.exports=a(678)},196:function(e,t,a){},678:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),s=a.n(i),o=(a(196),a(62)),l=a.n(o),c=a(98),u=a(70),m=a(45),h=a(170),d=a(171),g=a(182),p=a(706),v=a(710),f=a(711),b=a(712),w=a(716),_=a(714),k=a(713),y=a(680),E=a(715),S=a(717),C=a(180),z=a.n(C),I=a(60),O=a.n(I),P=a(181),x=a(41),A=a(175),j={Auth:{identityPoolId:"us-west-2:f533019d-9cbe-4a39-ad43-574c7316ad26",region:"us-west-2",userPoolId:"us-west-2_d9YBsfCk1",userPoolWebClientId:"54n46fo7gq5vprpg74qo4b8825",mandatorySignIn:!0,oauth:{domain:"braingeneers.auth.us-west-2.amazoncognito.com",scope:["email","openid","profile"],redirectSignIn:"localhost"===window.location.hostname?"http://localhost:3000/":"https://braingeneers.gi.ucsc.edu/things/",redirectSignOut:"localhost"===window.location.hostname?"http://localhost:3000/":"https://braingeneers.gi.ucsc.edu/things/",responseType:"token"}}};x.c.configure(j);var T=[{value:"gfp",label:"GFP"},{value:"white",label:"Bright Field"}],B=[{value:"-t 4000 -ss 2500000 -awb off -awbg 1,1 -o",label:"GFP"},{value:"-t 4000 -awb off -awbg 1,1 -o",label:"Bright Field"}],D=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={user:null,iot:null,things:null,uuid:(new Date).toISOString().split("T")[0],interval:2,stack_size:5,stack_offset:500,step_size:100,camera_params:"-t 4000 -awb off -awbg 1,1 -o",light_mode:"white",loaded:!1,authenticated:!1},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,x.a.currentAuthenticatedUser();case 3:return e.t1=e.sent,e.t2={user:e.t1},e.t0.setState.call(e.t0,e.t2),e.next=8,x.a.currentCredentials();case 8:return t=e.sent,O.a.config.update({region:j.Auth.region,accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,sessionToken:t.sessionToken}),e.prev=10,a=new O.a.Iot({credentials:t}),this.setState({iot:a}),e.t3=this,e.next=16,this.state.iot.listThings().promise();case 16:e.t4=e.sent,e.t5={things:e.t4},e.t3.setState.call(e.t3,e.t5),a.attachPrincipalPolicy({policyName:"default",principal:t.identityId},(function(e,t){e&&console.error(e)})),x.c.addPluggable(new A.AWSIoTProvider({aws_pubsub_region:j.Auth.region,aws_pubsub_endpoint:"wss://ahp00abmtph4i-ats.iot.us-west-2.amazonaws.com/mqtt"})),x.b.subscribe("picroscope/#").subscribe({next:function(e){return console.log("Message received",e)},error:function(e){return console.error(e)},close:function(){return console.log("Done")}}),this.setState({authenticated:!0}),e.next=28;break;case 25:e.prev=25,e.t6=e.catch(10),console.log("Unable to authenticate",e.t6);case 28:this.setState({loaded:!0});case 29:case"end":return e.stop()}}),e,this,[[10,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var e=Object(c.a)(l.a.mark((function e(t,a){var n,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>2&&void 0!==r[2]?r[2]:{},console.log("".concat(t,"/").concat(a),n),e.next=4,x.b.publish("".concat(t,"/").concat(a),n);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loaded?this.state.authenticated?r.a.createElement("form",null,r.a.createElement(p.a,{position:"static"},r.a.createElement(b.a,null,r.a.createElement("img",{src:"logo36.png",alt:"Braingeneers"}),r.a.createElement(v.a,{color:"inherit",onClick:function(){return x.a.signOut()}},"Logout"))),r.a.createElement(w.a,{id:"uuid",label:"UUID",value:this.state.uuid,onChange:function(t){return e.setState({uuid:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"stack_size",label:"Stack Size",value:this.state.stack_size,onChange:function(t){return e.setState({stack_size:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"step_size",label:"Step Size",value:this.state.step_size,onChange:function(t){return e.setState({step_size:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"stack_offset",label:"Step Offset",value:this.state.stack_offset,onChange:function(t){return e.setState({stack_offset:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"interval",label:"Interval (hours)",value:this.state.interval,onChange:function(t){return e.setState({interval:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"camera_params",label:"Camera Command Parameters",value:this.state.camera_params,onChange:function(t){return e.setState({camera_params:t.target.value})},margin:"normal",variant:"outlined"}),r.a.createElement(w.a,{id:"outlined-select-cam-params",select:!0,label:"Camera Parameter Presets",value:this.state.camera_params,onChange:function(t){return e.setState({camera_params:t.target.value})},margin:"normal",style:{width:190},variant:"outlined"},B.map((function(e){return r.a.createElement(_.a,{key:e.value,value:e.value},e.label)}))),r.a.createElement(w.a,{id:"outlined-select-currency",select:!0,label:"Light Type",value:this.state.light_mode,onChange:function(t){return e.setState({light_mode:t.target.value})},margin:"normal",style:{width:190},variant:"outlined"},T.map((function(e){return r.a.createElement(_.a,{key:e.value,value:e.value},e.label)}))),r.a.createElement(k.a,null,this.state.things.things.map((function(t){return r.a.createElement(y.a,{key:t.thingArn},r.a.createElement(E.a,null,r.a.createElement(z.a,null)),r.a.createElement(S.a,{primary:t.thingName}),r.a.createElement(v.a,{variant:"outlined",color:"primary",onClick:function(){return e.publish(t.thingName,"start",{uuid:e.state.uuid,params:{interval:e.state.interval,stack_size:e.state.stack_size,stack_offset:e.state.stack_offset,step_size:e.state.step_size,camera_params:e.state.camera_params,light_mode:e.state.light_mode}})}},"Start"),r.a.createElement(v.a,{variant:"outlined",color:"secondary",onClick:function(){return e.publish(t.thingName,"stop",{})}},"Stop"))})))):r.a.createElement("div",null,r.a.createElement(p.a,{position:"static"},r.a.createElement(v.a,{color:"inherit",onClick:function(){return x.a.signOut()}},"Logout")),r.a.createElement(f.a,null,"You're email address has not been authorized")):r.a.createElement("div",null,"Loading...")}}]),t}(n.Component),F=Object(P.a)(D);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},81:function(e,t){},88:function(e,t){}},[[191,1,2]]]);
//# sourceMappingURL=main.9c6b8e7d.chunk.js.map